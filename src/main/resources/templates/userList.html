<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>회원 관리</title>
  <script>
    async function loadUsers() {
        const res = await fetch('/users/all');
        const users = await res.json();
        const tbody = document.getElementById('userTableBody');
        tbody.innerHTML = '';
        users.forEach(u => {
            tbody.innerHTML += `
            <tr>
                <td>${u.id}</td>
                <td>${u.username}</td>
                <td>${u.email}</td>
                <td>${u.admin}</td>
                <td>${u.status}</td>
                <td>
                    ${u.status === 'PENDING' ? `<button onclick="approveUser(${u.id})">승인</button>` : ''}
                </td>
            </tr>`;
        });
    }

    async function approveUser(id) {
        await fetch(`/users/approve/${id}`, { method: 'PUT' });
        loadUsers();
    }

    window.onload = loadUsers;
  </script>
</head>
<body>
<h1>회원 관리 페이지 (관리자용)</h1>
<table border="1">
  <thead>
  <tr>
    <th>ID</th>
    <th>사용자 이름</th>
    <th>이메일</th>
    <th>관리자 여부</th>
    <th>상태</th>
    <th>승인</th>
  </tr>
  </thead>
  <tbody id="userTableBody"></tbody>
</table>
</body>
</html>
