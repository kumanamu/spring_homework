<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <meta charset="UTF-8"/>
  <title>회원 목록</title>
  <style>
    body { font-family: sans-serif; max-width: 900px; margin: 24px auto; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background: #f4f4f4; }
    .pill { padding: 2px 8px; border-radius: 12px; font-size: 12px; }
    .ok { background:#e6ffed; color:#057a55; }
    .no { background:#fff5f5; color:#c53030; }
    form { display:inline; margin:0; }
    .actions button { margin-right: 6px; }
  </style>
</head>
<body>
<h2>회원 목록</h2>

<table>
  <thead>
  <tr>
    <th>ID</th>
    <th>아이디</th>
    <th>이메일</th>
    <th>닉네임</th>
    <th>승인</th>
    <th>관리자</th>
    <th>맞/틀</th>
    <th>생성일</th>
    <th>작업</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="u : ${users}">
    <td th:text="${u.id}">1</td>
    <td th:text="${u.username}">user</td>
    <td th:text="${u.email}">user@ex.com</td>
    <td th:text="${u.nickname}">nick</td>
    <td>
      <span th:classappend="${u.status} ? 'pill ok' : 'pill no'"
            th:text="${u.status} ? '승인됨' : '대기'">대기</span>
    </td>
    <td th:text="${u.admin}">false</td>
    <td><span th:text="${u.answerTrue}">0</span> / <span th:text="${u.answerFalse}">0</span></td>
    <td th:text="${#temporals.format(u.createdAt, 'yyyy-MM-dd HH:mm')}">2025-08-21</td>
    <td class="actions">
      <!-- 승인 대기 → 승인 -->
      <form th:if="${!u.status}" th:action="@{/admin/users/{id}/approve(id=${u.id})}" method="post">
        <input type="hidden" name="redirect" th:value="@{/users/list}"/>
        <button type="submit">승인</button>
      </form>
      <!-- 승인됨 → 거절(비활성화) -->
      <form th:if="${u.status}" th:action="@{/admin/users/{id}/reject(id=${u.id})}" method="post">
        <input type="hidden" name="redirect" th:value="@{/users/list}"/>
        <button type="submit">거절</button>
      </form>
    </td>
  </tr>
  </tbody>
</table>

<p style="margin-top:12px;">
  <a th:href="@{/admin}">관리자 대시보드</a>
</p>
</body>
</html>
