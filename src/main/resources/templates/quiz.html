<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>퀴즈 풀기</title>
    <link rel="stylesheet" href="/css/main.css">
    <script>
        // 정답 제출
        function submitAnswer(quizId) {
            const userAnswer = document.getElementById('answer-' + quizId).value;
            fetch('/results', {
                method: 'POST',
                headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                body: `userId=${document.getElementById('userId').value}&quizId=${quizId}&userAnswer=${userAnswer}`
            })
            .then(response => response.json())
            .then(data => {
                alert(data.correct ? "정답!" : "오답!");
                location.reload();
            })
            .catch(error => console.error(error));
        }
    </script>
</head>
<body>
<h1>랜덤 퀴즈 풀기</h1>
<input type="hidden" id="userId" th:value="${user.id}" />
<div th:each="quiz : ${quizzes}">
    <p><strong th:text="${quiz.question}"></strong></p>
    <input type="text" th:id="'answer-' + ${quiz.id}" placeholder="답 입력">
    <button th:onclick="'submitAnswer(' + ${quiz.id} + ')'">제출</button>
    <hr>
</div>
</body>
</html>
